import{_ as A}from"./AdminLayout.90f2d3cf.js";import{q as N}from"./index.f92e3654.js";import{_ as z}from"./_plugin-vue_export-helper.cdc0426e.js";import{U as B}from"./UploadOutlined.db7588f1.js";import{R as L}from"./RestFilled.8644bff0.js";import{C as w,D as g,o as s,d as p,b as d,w as t,F as b,a as _,f as l,t as u,e as r,n as T,c as k,h as V}from"./app.5bc04564.js";import"./UserOutlined.9b50d372.js";import"./AppstoreOutlined.68a63fa9.js";const D={components:{AdminLayout:A,UploadOutlined:B,RestFilled:L,quillEditor:N},props:["states","applications"],data(){return{loading:!1,modal:{isOpen:!1,data:{published:1},title:"\u516C\u544A",mode:""},pagination:{total:this.applications.total,current:this.applications.current_page,pageSize:this.applications.per_page},filter:{},columns:[{title:"\u6A19\u984C",dataIndex:"form_id",key:"form_id"},{title:"\u540D\u7A31",dataIndex:"user_id",key:"name"},{title:"\u96FB\u90F5",dataIndex:"user_id",key:"email"},{title:"\u72C0\u614B",dataIndex:"state",key:"state"},{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation"}],rules:{title:{required:!0},date:{required:!0},category:{required:!0}},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},labelCol:{style:{width:"150px"}}}},created(){console.log(this.applications)},compunted:{pagination(){return{total:this.applications.total,current:this.applications.current_page,pageSize:this.applications.per_page}}},methods:{showRecord(n){this.modal.data={...n},this.modal.mode="SHOW",this.modal.isOpen=!0},passRecord(n,i,f){this.$inertia.post("/admin/applications/"+n+"/changeState",{state:i,remark:f},{onSuccess:c=>{console.log(c),w.success("\u5DF2\u901A\u904E\u6B64\u5831\u540D")},onError:c=>{console.log(c)}})},rejectRecord(n,i,f){this.$inertia.post("/admin/applications/"+n+"/changeState",{state:i,remark:f},{onSuccess:c=>{console.log(c),w.success("\u5DF2\u62D2\u7D55\u6B64\u5831\u540D")},onError:c=>{console.log(c)}})},deleteRecord(n){this.$inertia.delete("/admin/applications/"+n,{preserveState:!1,onSuccess:i=>{console.log(i)},onError:i=>{alert(i.message)}})},onPaginationChange(n,i,f){this.$inertia.get(route("admin.applications.index"),{page:n.current,per_page:n.pageSize})}}},F={class:"p-8 pt-8"},U=_("div",{class:"flex pb-2"},[_("div",{class:"flex-auto w-1/2 font-semibold text-xl text-gray-800 truncate whitespace-nowrap"}," \u5831\u540D\u7BA1\u7406 ")],-1),j={class:"card drop-shadow-md pt-4"},P={key:3,class:"flex"},H={key:5,class:"space-x-2"},J=_("div",{class:"text-base font-bold mt-4"},"\u7E73\u8CBB\u55AE",-1),M={key:0},W=["href"],G=["src"];function K(n,i,f,c,a,h){const x=g("a-button"),y=g("a-popconfirm"),R=g("a-table"),E=g("AdminLayout"),v=g("a-descriptions-item"),O=g("a-descriptions"),q=g("a-modal");return s(),p(b,null,[d(E,{title:"\u5831\u540D\u7BA1\u7406"},{default:t(()=>[_("div",F,[U,_("div",j,[d(R,{dataSource:f.applications.data,columns:a.columns,pagination:a.pagination,onChange:h.onPaginationChange,ref:"dataTable"},{bodyCell:t(({column:o,record:e})=>[o.key=="form_id"?(s(),p(b,{key:0},[l(u(e.form.title),1)],64)):r("",!0),o.key=="name"?(s(),p(b,{key:1},[l(u(e.user.name),1)],64)):r("",!0),o.key=="email"?(s(),p(b,{key:2},[l(u(e.user.email),1)],64)):r("",!0),o.key=="state"?(s(),p("div",P,[_("div",{class:T(["p-1 px-2 rounded-md border border-solid",e.state==1?"text-blue-500 bg-blue-100":e.state==4?"text-red-500 bg-red-100":"text-green-500 bg-green-100"])},u(f.states.find(m=>m.value==e.state).label),3)])):r("",!0),o.key=="published"?(s(),p(b,{key:4},[l(u(e.published==1?"\u767C\u4F48":"\u975E\u767C\u4F48"),1)],64)):r("",!0),o.dataIndex=="operation"?(s(),p("div",H,[d(x,{onClick:m=>h.showRecord(e)},{default:t(()=>[l("\u67E5\u770B")]),_:2},1032,["onClick"]),e.state==0?(s(),k(y,{key:0,title:"\u662F\u5426\u78BA\u5B9A\u901A\u904E\u9019\u500B\u5831\u540D","ok-text":"\u662F","cancel-text":"\u5426",onConfirm:m=>h.passRecord(e.id,1)},{default:t(()=>[d(x,null,{default:t(()=>[l("\u901A\u904E")]),_:1})]),_:2},1032,["onConfirm"])):r("",!0),e.state==2?(s(),k(y,{key:1,title:"\u662F\u5426\u78BA\u5B9A\u9019\u500B\u5831\u540D\u7684\u7E73\u8CBB\u55AE","ok-text":"\u662F","cancel-text":"\u5426",onConfirm:m=>h.passRecord(e.id,3)},{default:t(()=>[d(x,null,{default:t(()=>[l("\u78BA\u5B9A")]),_:1})]),_:2},1032,["onConfirm"])):r("",!0),e.state==0||e.state==2?(s(),k(y,{key:2,title:"\u662F\u5426\u78BA\u5B9A\u62D2\u7D55\u9019\u500B\u5831\u540D","ok-text":"\u662F","cancel-text":"\u5426",onConfirm:m=>h.rejectRecord(e.id,4)},{default:t(()=>[d(x,null,{default:t(()=>[l("\u62D2\u7D55")]),_:1})]),_:2},1032,["onConfirm"])):r("",!0)])):r("",!0)]),_:1},8,["dataSource","columns","pagination","onChange"])])])]),_:1}),d(q,{visible:a.modal.isOpen,"onUpdate:visible":i[1]||(i[1]=o=>a.modal.isOpen=o),title:a.modal.mode=="CREATE"?"\u65B0\u589E":a.modal.mode=="EDIT"?"\u4FEE\u6539":"\u67E5\u770B",width:"60%"},{footer:t(()=>[d(x,{onClick:i[0]||(i[0]=o=>a.modal.isOpen=!1)},{default:t(()=>[l("Close")]),_:1})]),default:t(()=>[d(O,{title:"\u8868\u683C\u5167\u5BB9",bordered:"",column:{xs:1,sm:2}},{default:t(()=>[d(v,{label:"\u59D3\u540D"},{default:t(()=>[l(u(a.modal.data.user.name),1)]),_:1}),d(v,{label:"\u96FB\u90F5"},{default:t(()=>[l(u(a.modal.data.user.email),1)]),_:1}),(s(!0),p(b,null,V(a.modal.data.form.fields,o=>(s(),k(v,{label:o.field_label},{default:t(()=>{var e,m;return[l(u(o.options?(e=JSON.parse(o.options).find(C=>{var S;return C.value==((S=a.modal.data.fields.find(I=>I.field_id==o.id))==null?void 0:S.value)}))==null?void 0:e.label:(m=a.modal.data.fields.find(C=>C.field_id==o.id))==null?void 0:m.value),1)]}),_:2},1032,["label"]))),256))]),_:1}),J,a.modal.data.url?(s(),p("div",M,[_("a",{href:a.modal.data.url,target:"_blank"},[_("img",{src:a.modal.data.url,class:"h-64 w-64"},null,8,G)],8,W)])):r("",!0)]),_:1},8,["visible","title"])],64)}const oe=z(D,[["render",K]]);export{oe as default};
