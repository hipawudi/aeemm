import{_ as A}from"./AdminLayout.ecf5373d.js";import{q as V}from"./index.54638dd9.js";import{_ as Y}from"./_plugin-vue_export-helper.cdc0426e.js";import{U as B}from"./UploadOutlined.95ecb675.js";import{R as L}from"./RestFilled.7dbd073e.js";import{C as b,D as i,o as m,c as v,w as n,a as s,b as l,f as r,d as h,t as x,F as C,e as _}from"./app.25506e31.js";import"./UserOutlined.59aec3f0.js";import"./AppstoreOutlined.8da2a6ad.js";const M={components:{AdminLayout:A,UploadOutlined:B,RestFilled:L,quillEditor:V},props:["bulletinCategories","bulletins"],data(){return{dateFormat:"YYYY-MM-DD",yearCurrent:2023,yearStart:new Date().getFullYear()+1,yearLength:new Date().getFullYear()-2009+2,loading:!1,modal:{isOpen:!1,data:{published:1},title:"\u516C\u544A",mode:""},pagination:{total:this.bulletins.total,current:this.bulletins.current_page,pageSize:this.bulletins.per_page},filter:{},columns:[{title:"\u6A19\u984C",dataIndex:"title"},{title:"\u65E5\u671F",dataIndex:"date"},{title:"\u5206\u985E",dataIndex:"category"},{title:"\u767C\u4F48",dataIndex:"published",key:"published"},{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation"}],rules:{title:{required:!0},date:{required:!0},category:{required:!0}},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},labelCol:{style:{width:"150px"}}}},created(){},compunted:{pagination(){return{total:this.bulletins.total,current:this.bulletins.current_page,pageSize:this.bulletins.per_page}}},methods:{createRecord(a){this.modal.data={published:1},this.modal.mode="CREATE",this.modal.isOpen=!0},editRecord(a){this.modal.data={...a},this.modal.mode="EDIT",console.log(a),this.modal.isOpen=!0},storeRecord(){this.loading=!0,this.$refs.modalRef.validateFields().then(()=>{this.$inertia.post(route("admin.bulletins.store"),this.modal.data,{preserveState:!1,onSuccess:a=>{this.modal.isOpen=!1,console.log(a),b.success("\u65B0\u589E\u6210\u529F")},onError:a=>{console.log(a)},onFinish:a=>{this.loading=!1}})}).catch(a=>{this.loading=!1,console.log(a)})},updateRecord(){this.$refs.modalRef.validateFields().then(()=>{this.modal.data._method="PATCH",this.$inertia.post(route("admin.bulletins.update",this.modal.data.id),this.modal.data,{preserveState:!1,onSuccess:a=>{this.modal.isOpen=!1,b.success("\u4FEE\u6539\u6210\u529F")},onError:a=>{console.log(a),b.error(a.error)}})}).catch(a=>{console.log("error",a)})},deleteRecord(a){this.$inertia.delete("/admin/bulletins/"+a,{preserveState:!1,onSuccess:t=>{console.log(t)},onError:t=>{alert(t.message)}})},onPaginationChange(a,t,c){this.$inertia.get(route("admin.bulletins.index"),{page:a.current,per_page:a.pageSize})}}},N={class:"md:p-8 pt-8"},z={class:"flex pb-2"},P=s("div",{class:"flex-auto w-1/2 font-semibold text-xl text-gray-800 truncate whitespace-nowrap"}," \u516C\u544A\u7BA1\u7406 ",-1),H={class:"flex-auto w-1/2 text-right"},j={class:"container mx-auto pt-5"},G={class:"bg-white relative shadow rounded-lg overflow-x-auto"},J={key:1,class:"space-x-2"},K=s("div",{style:{"margin-top":"8px"}},"Upload",-1);function Q(a,t,c,W,e,u){const p=i("a-button"),k=i("a-popconfirm"),R=i("a-table"),w=i("a-select"),d=i("a-form-item"),S=i("a-date-picker"),y=i("a-input"),U=i("a-textarea"),E=i("a-switch"),F=i("upload-outlined"),I=i("a-upload"),D=i("a-form"),O=i("a-modal"),T=i("AdminLayout");return m(),v(T,{title:"\u516C\u544A\u7BA1\u7406"},{default:n(()=>[s("div",N,[s("div",z,[P,s("div",H,[l(p,{type:"primary",class:"!rounded",onClick:t[0]||(t[0]=o=>u.createRecord())},{default:n(()=>[r("\u65B0\u589E\u516C\u544A")]),_:1})])]),s("div",j,[s("div",G,[l(R,{dataSource:c.bulletins.data,columns:e.columns,pagination:e.pagination,onChange:u.onPaginationChange,ref:"dataTable"},{bodyCell:n(({column:o,text:q,record:f})=>[o.key=="published"?(m(),h(C,{key:0},[r(x(f.published==1?"\u767C\u4F48":"\u975E\u767C\u4F48"),1)],64)):_("",!0),o.dataIndex=="operation"?(m(),h("div",J,[l(p,{onClick:g=>u.editRecord(f)},{default:n(()=>[r("\u4FEE\u6539")]),_:2},1032,["onClick"]),l(k,{title:"\u662F\u5426\u78BA\u5B9A\u522A\u9664\u9019\u500B\u516C\u544A","ok-text":"\u662F","cancel-text":"\u5426",onConfirm:g=>u.deleteRecord(f.id)},{default:n(()=>[l(p,null,{default:n(()=>[r("\u522A\u9664")]),_:1})]),_:2},1032,["onConfirm"])])):o.dataIndex=="category"?(m(),h(C,{key:2},[r(x(c.bulletinCategories.find(g=>g.value==q).label),1)],64)):_("",!0)]),_:1},8,["dataSource","columns","pagination","onChange"])]),l(O,{visible:e.modal.isOpen,"onUpdate:visible":t[10]||(t[10]=o=>e.modal.isOpen=o),title:e.modal.mode=="CREATE"?"\u65B0\u589E":"\u4FEE\u6539",width:"60%"},{footer:n(()=>[e.modal.mode=="EDIT"?(m(),v(p,{loading:e.loading,key:"Update",type:"primary",onClick:t[8]||(t[8]=o=>u.updateRecord())},{default:n(()=>[r("\u4FEE\u6539")]),_:1},8,["loading"])):_("",!0),e.modal.mode=="CREATE"?(m(),v(p,{loading:e.loading,key:"Store",type:"primary",onClick:t[9]||(t[9]=o=>u.storeRecord())},{default:n(()=>[r("\u65B0\u589E")]),_:1},8,["loading"])):_("",!0)]),default:n(()=>[l(D,{ref:"modalRef",model:e.modal.data,"label-col":{span:4},"wrapper-col":{span:20},rules:e.rules,"validate-messages":e.validateMessages},{default:n(()=>[l(d,{label:"\u5206\u985E",name:"category"},{default:n(()=>[l(w,{value:e.modal.data.category,"onUpdate:value":t[1]||(t[1]=o=>e.modal.data.category=o),options:c.bulletinCategories},null,8,["value","options"])]),_:1}),l(d,{label:"\u65E5\u671F",name:"date"},{default:n(()=>[l(S,{value:e.modal.data.date,"onUpdate:value":t[2]||(t[2]=o=>e.modal.data.date=o),format:e.dateFormat,valueFormat:e.dateFormat},null,8,["value","format","valueFormat"])]),_:1}),l(d,{label:"\u6A19\u984C",name:"title"},{default:n(()=>[l(y,{value:e.modal.data.title,"onUpdate:value":t[3]||(t[3]=o=>e.modal.data.title=o)},null,8,["value"])]),_:1}),l(d,{label:"\u63CF\u8FF0",name:"description"},{default:n(()=>[l(y,{value:e.modal.data.description,"onUpdate:value":t[4]||(t[4]=o=>e.modal.data.description=o)},null,8,["value"])]),_:1}),l(d,{label:"\u5167\u5BB9",name:"content"},{default:n(()=>[l(U,{value:e.modal.data.content,"onUpdate:value":t[5]||(t[5]=o=>e.modal.data.content=o)},null,8,["value"])]),_:1}),l(d,{label:"\u767C\u4F48",name:"published"},{default:n(()=>[l(E,{checked:e.modal.data.published,"onUpdate:checked":t[6]||(t[6]=o=>e.modal.data.published=o),unCheckedValue:0,checkedValue:1},null,8,["checked"])]),_:1}),l(d,{label:"\u76F8\u7247",name:"images"},{default:n(()=>[l(I,{"file-list":e.modal.data.images,"onUpdate:fileList":t[7]||(t[7]=o=>e.modal.data.images=o),"list-type":"picture-card",beforeUpload:()=>!1},{default:n(()=>[s("div",null,[l(F),K])]),_:1},8,["file-list","beforeUpload"])]),_:1})]),_:1},8,["model","rules","validate-messages"])]),_:1},8,["visible","title"])])])]),_:1})}const ne=Y(M,[["render",Q]]);export{ne as default};
