import{_ as B}from"./AdminLayout.cdea8187.js";import{q as V}from"./index.155b5067.js";import{_ as Y}from"./_plugin-vue_export-helper.cdc0426e.js";import{U as L}from"./UploadOutlined.4361b0ad.js";import{R as M}from"./RestFilled.9e92e777.js";import{C as x,D as i,o as u,c as v,w as n,a as r,b as o,f as s,d as h,t as C,F as k,e as f}from"./app.f3049ff6.js";import"./UserOutlined.8c511291.js";import"./AppstoreOutlined.e3e7ae7c.js";const N={components:{AdminLayout:B,UploadOutlined:L,RestFilled:M,quillEditor:V},props:["bulletinCategories","bulletins"],data(){return{dateFormat:"YYYY-MM-DD",yearCurrent:2023,yearStart:new Date().getFullYear()+1,yearLength:new Date().getFullYear()-2009+2,modal:{isOpen:!1,data:{published:1},title:"\u516C\u544A",mode:""},pagination:{total:this.bulletins.total,current:this.bulletins.current_page,pageSize:this.bulletins.per_page},filter:{},columns:[{title:"\u6A19\u984C",dataIndex:"title"},{title:"\u65E5\u671F",dataIndex:"date"},{title:"\u5206\u985E",dataIndex:"category"},{title:"\u767C\u4F48",dataIndex:"published",key:"published"},{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation"}],rules:{field:{required:!0},label:{required:!0}},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},labelCol:{style:{width:"150px"}}}},created(){},methods:{createRecord(l){this.modal.data={published:1},this.modal.mode="CREATE",this.modal.isOpen=!0},editRecord(l){this.modal.data={...l},l.cover_image_path&&(this.modal.data.cover=[{name:l.cover_image_path.split("/").pop(),url:l.cover_url}]),this.modal.mode="EDIT",this.modal.isOpen=!0},storeRecord(){this.$refs.modalRef.validateFields().then(()=>{this.$inertia.post(route("admin.bulletins.store"),this.modal.data,{onSuccess:l=>{this.modal.isOpen=!1,x.success("\u65B0\u589E\u6210\u529F")},onError:l=>{console.log(l)}})}).catch(l=>{console.log(l)})},updateRecord(){this.$refs.modalRef.validateFields().then(()=>{this.modal.data._method="PATCH",this.$inertia.post(route("admin.bulletins.update",this.modal.data.id),this.modal.data,{onSuccess:l=>{this.modal.isOpen=!1,x.success("\u4FEE\u6539\u6210\u529F")},onError:l=>{console.log(l)}})}).catch(l=>{console.log("error",l)})},deleteRecord(l){this.$inertia.delete("/admin/bulletins/"+l,{onSuccess:e=>{console.log(e)},onError:e=>{alert(e.message)}})},onPaginationChange(l,e,c){this.$inertia.get(route("admin.bulletins.index"),{page:l.current,per_page:5,filter:"namejose"},{onSuccess:_=>{console.log(_)},onError:_=>{console.log(_)}})}}},P={class:"p-8 pt-8"},j={class:"flex pb-2"},z=r("div",{class:"flex-auto w-1/2 font-semibold text-xl text-gray-800 truncate whitespace-nowrap"}," \u516C\u544A\u7BA1\u7406 ",-1),H={class:"flex-auto w-1/2 text-right"},G={class:"card drop-shadow-md pt-4"},J={key:1,class:"space-x-2"},K=r("div",{style:{"margin-top":"8px"}},"Upload",-1);function Q(l,e,c,_,t,m){const p=i("a-button"),R=i("a-popconfirm"),w=i("a-table"),U=i("a-select"),d=i("a-form-item"),E=i("a-date-picker"),y=i("a-input"),F=i("quill-editor"),S=i("a-switch"),D=i("upload-outlined"),I=i("a-upload"),q=i("a-form"),O=i("a-modal"),A=i("AdminLayout");return u(),v(A,{title:"Dashboard"},{default:n(()=>[r("div",P,[r("div",j,[z,r("div",H,[o(p,{type:"primary",class:"!rounded",onClick:e[0]||(e[0]=a=>m.createRecord())},{default:n(()=>[s("\u65B0\u589E\u516C\u544A")]),_:1})])]),r("div",G,[o(w,{dataSource:c.bulletins.data,columns:t.columns,pagination:t.pagination,onChange:m.onPaginationChange,ref:"dataTable"},{bodyCell:n(({column:a,text:T,record:b,index:W})=>[a.key=="published"?(u(),h(k,{key:0},[s(C(b.published==1?"\u767C\u4F48":"\u975E\u767C\u4F48"),1)],64)):f("",!0),a.dataIndex=="operation"?(u(),h("div",J,[o(p,{onClick:g=>m.editRecord(b)},{default:n(()=>[s("\u4FEE\u6539")]),_:2},1032,["onClick"]),o(R,{title:"\u662F\u5426\u78BA\u5B9A\u522A\u9664\u9019\u500B\u516C\u544A","ok-text":"\u662F","cancel-text":"\u5426",onConfirm:g=>m.deleteRecord(b.id)},{default:n(()=>[o(p,null,{default:n(()=>[s("\u522A\u9664")]),_:1})]),_:2},1032,["onConfirm"])])):a.dataIndex=="category"?(u(),h(k,{key:2},[s(C(c.bulletinCategories.find(g=>g.value==T).label),1)],64)):f("",!0)]),_:1},8,["dataSource","columns","pagination","onChange"])]),o(O,{visible:t.modal.isOpen,"onUpdate:visible":e[10]||(e[10]=a=>t.modal.isOpen=a),title:t.modal.title,width:"60%"},{footer:n(()=>[t.modal.mode=="EDIT"?(u(),v(p,{key:"Update",type:"primary",onClick:e[8]||(e[8]=a=>m.updateRecord())},{default:n(()=>[s("Update")]),_:1})):f("",!0),t.modal.mode=="CREATE"?(u(),v(p,{key:"Store",type:"primary",onClick:e[9]||(e[9]=a=>m.storeRecord())},{default:n(()=>[s("Add")]),_:1})):f("",!0)]),default:n(()=>[o(q,{ref:"modalRef",model:t.modal.data,name:"Bulletin","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",rules:t.rules,"validate-messages":t.validateMessages},{default:n(()=>[o(d,{label:"\u5206\u985E",name:"category"},{default:n(()=>[o(U,{value:t.modal.data.category,"onUpdate:value":e[1]||(e[1]=a=>t.modal.data.category=a),options:c.bulletinCategories},null,8,["value","options"])]),_:1}),o(d,{label:"\u65E5\u671F",name:"date"},{default:n(()=>[o(E,{value:t.modal.data.date,"onUpdate:value":e[2]||(e[2]=a=>t.modal.data.date=a),format:t.dateFormat,valueFormat:t.dateFormat},null,8,["value","format","valueFormat"])]),_:1}),o(d,{label:"\u6A19\u984C",name:"title"},{default:n(()=>[o(y,{value:t.modal.data.title,"onUpdate:value":e[3]||(e[3]=a=>t.modal.data.title=a)},null,8,["value"])]),_:1}),o(d,{label:"\u63CF\u8FF0",name:"description"},{default:n(()=>[o(y,{value:t.modal.data.description,"onUpdate:value":e[4]||(e[4]=a=>t.modal.data.description=a)},null,8,["value"])]),_:1}),o(d,{label:"\u5167\u5BB9",name:"content"},{default:n(()=>[o(F,{value:t.modal.data.content,"onUpdate:value":e[5]||(e[5]=a=>t.modal.data.content=a),style:{"min-height":"200px"}},null,8,["value"])]),_:1}),o(d,{label:"\u767C\u4F48",name:"published"},{default:n(()=>[o(S,{checked:t.modal.data.published,"onUpdate:checked":e[6]||(e[6]=a=>t.modal.data.published=a),unCheckedValue:0,checkedValue:1},null,8,["checked"])]),_:1}),o(d,{label:"\u5C01\u9762",name:"cover"},{default:n(()=>[o(I,{"file-list":t.modal.data.cover,"onUpdate:fileList":e[7]||(e[7]=a=>t.modal.data.cover=a),multiple:!1,beforeUpload:l.openCropModal,"max-count":1,"list-type":"picture-card"},{default:n(()=>[r("div",null,[o(D),K])]),_:1},8,["file-list","beforeUpload"])]),_:1})]),_:1},8,["model","rules","validate-messages"])]),_:1},8,["visible","title"])])]),_:1})}const ne=Y(N,[["render",Q]]);export{ne as default};
