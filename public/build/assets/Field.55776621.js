import{_ as A}from"./AdminLayout.b1278d3d.js";import{_ as S}from"./_plugin-vue_export-helper.cdc0426e.js";import{C as h,D as s,o as c,c as x,w as o,a as d,b as t,f as r,d as v,e as b,F as V,h as F,t as y}from"./app.8d6b5d0d.js";import"./UserOutlined.74c238c8.js";import"./AppstoreOutlined.5537e5f8.js";const N={components:{AdminLayout:A},props:["form","fields"],data(){return{optionInput:{},modal:{isOpen:!1,data:{},title:"Modal",mode:""},fieldTypes:[{value:"input",label:"\u55AE\u884C\u6587\u5B57",option:!1},{value:"textarea",label:"\u591A\u884C\u6587\u5B57",option:!1},{value:"largetext",label:"\u5927\u7BC7\u5E45\u6587\u5B57",option:!1},{value:"radio",label:"\u55AE\u9078",option:!0},{value:"checkbox",label:"\u591A\u9078",option:!0},{value:"true_false",label:"\u662F/\u5426",option:!1},{value:"date",label:"\u65E5\u671F",option:!1},{value:"datetime",label:"\u65E5\u671F\u6642\u9593",option:!1},{value:"email",label:"\u96FB\u90F5",option:!1},{value:"number",label:"\u6578\u503C",option:!1},{value:"richtext",label:"\u5BCC\u6587\u672C\u683C\u5F0F",option:!1},{value:"select",label:"\u4E0B\u62C9\u55AE",option:!0}],columns:[{title:"\u540D\u7A31",dataIndex:"field_name"},{title:"\u6A19\u7C3D",dataIndex:"field_label"},{title:"\u985E\u578B",dataIndex:"type"},{title:"\u5FC5\u586B",dataIndex:"required"},{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation"}],rules:{field:{required:!0},label:{required:!0}},validateMessages:{required:"\u8ACB\u8F93\u5165${label}",types:{email:"${label} \u4E0D\u662F\u6B63\u78BA\u7684\u90F5\u7BB1\u683C\u5F0F",number:"${label} \u4E0D\u662F\u6B63\u78BA\u7684\u6578\u5B57\u683C\u5F0F"},number:{range:"${label} \u5FC5\u9808\u5728${min}\u548C${max}\u4E4B\u9593"}},labelCol:{style:{width:"150px"}}}},created(){},methods:{createRecord(){this.modal.data={form_id:this.form.id,options:[],require:0},this.modal.mode="CREATE",this.modal.isOpen=!0},editRecord(n){var e;this.modal.data={...n},this.modal.data.options=(e=JSON.parse(this.modal.data.options))!=null?e:[],this.modal.mode="EDIT",this.modal.isOpen=!0},storeRecord(){this.$refs.modalRef.validateFields().then(()=>{this.$inertia.post(route("admin.forms.fields.store",{form:this.form.id}),this.modal.data,{onSuccess:n=>{this.modal.data={},this.modal.isOpen=!1,h.success("\u65B0\u589E\u6210\u529F")},onError:n=>{console.log(n)}})}).catch(n=>{console.log(n)})},updateRecord(){this.$refs.modalRef.validateFields().then(()=>{this.$inertia.patch(route("admin.forms.fields.update",{form:this.form.id,field:this.modal.data}),this.modal.data,{onSuccess:n=>{this.modal.data={},this.modal.isOpen=!1,h.success("\u4FEE\u6539\u6210\u529F")},onError:n=>{console.log(n)}})}).catch(n=>{console.log("error",n)})},deleteRecord(n){this.$inertia.delete(route("admin.forms.fields.destroy",{form:this.form.id,field:n.id}),{onSuccess:e=>{h.success("\u522A\u9664\u6210\u529F")},onError:e=>{alert(e.message)}})},addOptionItem(){console.log(this.modal.data),this.modal.data.options.push({value:this.optionInput.value,label:this.optionInput.label}),console.log(this.modal.data.options)},deleteOptionItem(n){this.modal.data.options.splice(n,1),console.log(this.modal.data.options)}}},B={class:"md:p-8 pt-8"},D={class:"flex pb-2"},L=d("div",{class:"flex-auto w-1/2 font-semibold text-xl text-gray-800 truncate whitespace-nowrap"}," \u8868\u683C\u6B04\u4F4D\u7BA1\u7406 ",-1),M={class:"flex-auto w-1/2 text-right"},J={class:"container mx-auto pt-5"},X={class:"bg-white relative shadow rounded-lg overflow-x-auto"},j={key:0,class:"space-x-2"},z={key:0},G=["onClick"];function H(n,e,k,K,l,m){const u=s("a-button"),g=s("a-popconfirm"),C=s("a-table"),f=s("a-input"),p=s("a-form-item"),I=s("a-select"),R=s("a-switch"),w=s("a-textarea"),O=s("a-form"),E=s("a-modal"),T=s("AdminLayout");return c(),x(T,{title:"\u8868\u683C\u6B04\u4F4D\u7BA1\u7406"},{default:o(()=>[d("div",B,[d("div",D,[L,d("div",M,[t(u,{type:"primary",class:"!rounded",onClick:e[0]||(e[0]=i=>m.createRecord())},{default:o(()=>[r("\u65B0\u589E\u8CC7\u6599\u6B04\u4F4D")]),_:1})])]),d("div",J,[d("div",X,[t(C,{dataSource:k.fields,columns:l.columns},{bodyCell:o(({column:i,text:a,record:_,index:U})=>[i.dataIndex=="operation"?(c(),v("div",j,[t(u,{onClick:q=>m.editRecord(_)},{default:o(()=>[r("\u4FEE\u6539")]),_:2},1032,["onClick"]),t(g,{title:"\u662F\u5426\u78BA\u5B9A\u522A\u9664\u9019\u500B\u6B04\u4F4D","ok-text":"\u662F","cancel-text":"\u5426",onConfirm:q=>m.deleteRecord(_)},{default:o(()=>[t(u,null,{default:o(()=>[r("\u522A\u9664")]),_:1})]),_:2},1032,["onConfirm"])])):b("",!0)]),_:1},8,["dataSource","columns"])])]),t(E,{visible:l.modal.isOpen,"onUpdate:visible":e[11]||(e[11]=i=>l.modal.isOpen=i),title:l.modal.mode=="CREATE"?"\u65B0\u589E":"\u4FEE\u6539",width:"60%"},{footer:o(()=>[t(u,{key:"back",onClick:e[8]||(e[8]=i=>l.modal.isOpen=!1)},{default:o(()=>[r("\u53D6\u6D88")]),_:1}),l.modal.mode=="EDIT"?(c(),x(u,{key:"Update",type:"primary",onClick:e[9]||(e[9]=i=>m.updateRecord())},{default:o(()=>[r("\u66F4\u65B0")]),_:1})):b("",!0),l.modal.mode=="CREATE"?(c(),x(u,{key:"Store",type:"primary",onClick:e[10]||(e[10]=i=>m.storeRecord())},{default:o(()=>[r("\u65B0\u589E")]),_:1})):b("",!0)]),default:o(()=>[t(O,{ref:"modalRef",model:l.modal.data,name:"Teacher","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",rules:l.rules,"validate-messages":l.validateMessages},{default:o(()=>{var i;return[t(p,{label:"\u540D\u7A31",name:"field_name"},{default:o(()=>[t(f,{value:l.modal.data.field_name,"onUpdate:value":e[1]||(e[1]=a=>l.modal.data.field_name=a)},null,8,["value"])]),_:1}),t(p,{label:"\u6A19\u7C3D",name:"field_label"},{default:o(()=>[t(f,{value:l.modal.data.field_label,"onUpdate:value":e[2]||(e[2]=a=>l.modal.data.field_label=a)},null,8,["value"])]),_:1}),t(p,{label:"\u985E\u578B",name:"type"},{default:o(()=>[t(I,{value:l.modal.data.type,"onUpdate:value":e[3]||(e[3]=a=>l.modal.data.type=a),placeholder:"\u6B04\u4F4D\u985E\u578B",options:l.fieldTypes},null,8,["value","options"])]),_:1}),(i=l.fieldTypes.find(a=>a.value==this.modal.data.type))!=null&&i.option?(c(),v("div",z,[t(p,{label:"Options",name:"options"},{default:o(()=>[d("ol",null,[(c(!0),v(V,null,F(l.modal.data.options,(a,_)=>(c(),v("li",null,[r(y(a.value)+": "+y(a.label)+" ",1),d("a",{onClick:U=>m.deleteOptionItem(_)},"X",8,G)]))),256))])]),_:1}),t(p,{label:"Add"},{default:o(()=>[d("table",null,[d("tr",null,[d("td",null,[t(f,{value:l.optionInput.value,"onUpdate:value":e[4]||(e[4]=a=>l.optionInput.value=a)},null,8,["value"])]),d("td",null,[t(f,{value:l.optionInput.label,"onUpdate:value":e[5]||(e[5]=a=>l.optionInput.label=a)},null,8,["value"])]),d("td",null,[t(u,{type:"primary",onClick:m.addOptionItem},{default:o(()=>[r("Add")]),_:1},8,["onClick"])])])])]),_:1})])):b("",!0),t(p,{label:"\u5FC5\u586B",name:"require"},{default:o(()=>[t(R,{checked:l.modal.data.require,"onUpdate:checked":e[6]||(e[6]=a=>l.modal.data.require=a),unCheckedValue:0,checkedValue:1},null,8,["checked"])]),_:1}),t(p,{label:"\u5099\u6CE8",name:"remark"},{default:o(()=>[t(w,{value:l.modal.data.remark,"onUpdate:value":e[7]||(e[7]=a=>l.modal.data.remark=a)},null,8,["value"])]),_:1})]}),_:1},8,["model","rules","validate-messages"])]),_:1},8,["visible","title"])])]),_:1})}const $=S(N,[["render",H]]);export{$ as default};
