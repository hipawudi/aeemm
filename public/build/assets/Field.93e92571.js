import{_ as S}from"./AdminLayout.ecf5373d.js";import{_ as U}from"./_plugin-vue_export-helper.cdc0426e.js";import{C as h,D as d,o as p,c as x,w as o,a as n,b as l,f as r,d as _,e as v,F as V,h as F,t as y}from"./app.25506e31.js";import"./UserOutlined.59aec3f0.js";import"./AppstoreOutlined.8da2a6ad.js";const N={components:{AdminLayout:S},props:["form","fields"],data(){return{optionInput:{},modal:{isOpen:!1,data:{},title:"Modal",mode:""},fieldTypes:[{value:"input",label:"\u55AE\u884C\u6587\u5B57",option:!1},{value:"textarea",label:"\u591A\u884C\u6587\u5B57",option:!1},{value:"largetext",label:"\u5927\u7BC7\u5E45\u6587\u5B57",option:!1},{value:"radio",label:"\u55AE\u9078",option:!0},{value:"checkbox",label:"\u591A\u9078",option:!0},{value:"true_false",label:"\u662F/\u5426",option:!1},{value:"date",label:"\u65E5\u671F",option:!1},{value:"datetime",label:"\u65E5\u671F\u6642\u9593",option:!1},{value:"email",label:"\u96FB\u90F5",option:!1},{value:"number",label:"\u6578\u503C",option:!1},{value:"richtext",label:"\u5BCC\u6587\u672C\u683C\u5F0F",option:!1},{value:"select",label:"\u4E0B\u62C9\u55AE",option:!0}],columns:[{title:"\u6A19\u7C3D",dataIndex:"field_label"},{title:"\u985E\u578B",dataIndex:"type"},{title:"\u5FC5\u586B",dataIndex:"required"},{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation"}],rules:{field:{required:!0},label:{required:!0}},validateMessages:{required:"\u8ACB\u8F93\u5165${label}",types:{email:"${label} \u4E0D\u662F\u6B63\u78BA\u7684\u90F5\u7BB1\u683C\u5F0F",number:"${label} \u4E0D\u662F\u6B63\u78BA\u7684\u6578\u5B57\u683C\u5F0F"},number:{range:"${label} \u5FC5\u9808\u5728${min}\u548C${max}\u4E4B\u9593"}},labelCol:{style:{width:"150px"}}}},created(){},methods:{createRecord(){this.modal.data={form_id:this.form.id,options:[],require:0},this.modal.mode="CREATE",this.modal.isOpen=!0},editRecord(s){var e;this.modal.data={...s},this.modal.data.options=(e=JSON.parse(this.modal.data.options))!=null?e:[],this.modal.mode="EDIT",this.modal.isOpen=!0},storeRecord(){this.$refs.modalRef.validateFields().then(()=>{this.$inertia.post(route("admin.forms.fields.store",{form:this.form.id}),this.modal.data,{onSuccess:s=>{this.modal.data={},this.modal.isOpen=!1,h.success("\u65B0\u589E\u6210\u529F")},onError:s=>{console.log(s)}})}).catch(s=>{console.log(s)})},updateRecord(){this.$refs.modalRef.validateFields().then(()=>{this.$inertia.patch(route("admin.forms.fields.update",{form:this.form.id,field:this.modal.data}),this.modal.data,{onSuccess:s=>{this.modal.data={},this.modal.isOpen=!1,h.success("\u4FEE\u6539\u6210\u529F")},onError:s=>{console.log(s)}})}).catch(s=>{console.log("error",s)})},deleteRecord(s){this.$inertia.delete(route("admin.forms.fields.destroy",{form:this.form.id,field:s.id}),{onSuccess:e=>{h.success("\u522A\u9664\u6210\u529F")},onError:e=>{alert(e.message)}})},addOptionItem(){console.log(this.modal.data),this.modal.data.options.push({value:this.optionInput.value,label:this.optionInput.label}),console.log(this.modal.data.options)},deleteOptionItem(s){this.modal.data.options.splice(s,1),console.log(this.modal.data.options)}}},B={class:"md:p-8 pt-8"},D={class:"flex pb-2"},L=n("div",{class:"flex-auto w-1/2 font-semibold text-xl text-gray-800 truncate whitespace-nowrap"}," \u8868\u683C\u6B04\u4F4D\u7BA1\u7406 ",-1),M={class:"flex-auto w-1/2 text-right"},J={class:"container mx-auto pt-5"},X={class:"bg-white relative shadow rounded-lg overflow-x-auto"},j={key:0,class:"space-x-2"},z={key:0},G=["onClick"];function H(s,e,k,K,t,m){const u=d("a-button"),g=d("a-popconfirm"),C=d("a-table"),b=d("a-input"),c=d("a-form-item"),I=d("a-select"),R=d("a-switch"),w=d("a-textarea"),O=d("a-form"),E=d("a-modal"),T=d("AdminLayout");return p(),x(T,{title:"\u8868\u683C\u6B04\u4F4D\u7BA1\u7406"},{default:o(()=>[n("div",B,[n("div",D,[L,n("div",M,[l(u,{type:"primary",class:"!rounded",onClick:e[0]||(e[0]=i=>m.createRecord())},{default:o(()=>[r("\u65B0\u589E\u8CC7\u6599\u6B04\u4F4D")]),_:1})])]),n("div",J,[n("div",X,[l(C,{dataSource:k.fields,columns:t.columns},{bodyCell:o(({column:i,text:a,record:f,index:q})=>[i.dataIndex=="operation"?(p(),_("div",j,[l(u,{onClick:A=>m.editRecord(f)},{default:o(()=>[r("\u4FEE\u6539")]),_:2},1032,["onClick"]),l(g,{title:"\u662F\u5426\u78BA\u5B9A\u522A\u9664\u9019\u500B\u6B04\u4F4D","ok-text":"\u662F","cancel-text":"\u5426",onConfirm:A=>m.deleteRecord(f)},{default:o(()=>[l(u,null,{default:o(()=>[r("\u522A\u9664")]),_:1})]),_:2},1032,["onConfirm"])])):v("",!0)]),_:1},8,["dataSource","columns"])])]),l(E,{visible:t.modal.isOpen,"onUpdate:visible":e[10]||(e[10]=i=>t.modal.isOpen=i),title:t.modal.mode=="CREATE"?"\u65B0\u589E":"\u4FEE\u6539",width:"60%"},{footer:o(()=>[l(u,{key:"back",onClick:e[7]||(e[7]=i=>t.modal.isOpen=!1)},{default:o(()=>[r("\u53D6\u6D88")]),_:1}),t.modal.mode=="EDIT"?(p(),x(u,{key:"Update",type:"primary",onClick:e[8]||(e[8]=i=>m.updateRecord())},{default:o(()=>[r("\u66F4\u65B0")]),_:1})):v("",!0),t.modal.mode=="CREATE"?(p(),x(u,{key:"Store",type:"primary",onClick:e[9]||(e[9]=i=>m.storeRecord())},{default:o(()=>[r("\u65B0\u589E")]),_:1})):v("",!0)]),default:o(()=>[l(O,{ref:"modalRef",model:t.modal.data,name:"Teacher","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",rules:t.rules,"validate-messages":t.validateMessages},{default:o(()=>{var i;return[l(c,{label:"\u6A19\u7C3D",name:"field_label"},{default:o(()=>[l(b,{value:t.modal.data.field_label,"onUpdate:value":e[1]||(e[1]=a=>t.modal.data.field_label=a)},null,8,["value"])]),_:1}),l(c,{label:"\u985E\u578B",name:"type"},{default:o(()=>[l(I,{value:t.modal.data.type,"onUpdate:value":e[2]||(e[2]=a=>t.modal.data.type=a),placeholder:"\u6B04\u4F4D\u985E\u578B",options:t.fieldTypes},null,8,["value","options"])]),_:1}),(i=t.fieldTypes.find(a=>a.value==this.modal.data.type))!=null&&i.option?(p(),_("div",z,[l(c,{label:"Options",name:"options"},{default:o(()=>[n("ol",null,[(p(!0),_(V,null,F(t.modal.data.options,(a,f)=>(p(),_("li",null,[r(y(a.value)+": "+y(a.label)+" ",1),n("a",{onClick:q=>m.deleteOptionItem(f)},"X",8,G)]))),256))])]),_:1}),l(c,{label:"Add"},{default:o(()=>[n("table",null,[n("tr",null,[n("td",null,[l(b,{value:t.optionInput.value,"onUpdate:value":e[3]||(e[3]=a=>t.optionInput.value=a)},null,8,["value"])]),n("td",null,[l(b,{value:t.optionInput.label,"onUpdate:value":e[4]||(e[4]=a=>t.optionInput.label=a)},null,8,["value"])]),n("td",null,[l(u,{type:"primary",onClick:m.addOptionItem},{default:o(()=>[r("Add")]),_:1},8,["onClick"])])])])]),_:1})])):v("",!0),l(c,{label:"\u5FC5\u586B",name:"require"},{default:o(()=>[l(R,{checked:t.modal.data.require,"onUpdate:checked":e[5]||(e[5]=a=>t.modal.data.require=a),unCheckedValue:0,checkedValue:1},null,8,["checked"])]),_:1}),l(c,{label:"\u5099\u6CE8",name:"remark"},{default:o(()=>[l(w,{value:t.modal.data.remark,"onUpdate:value":e[6]||(e[6]=a=>t.modal.data.remark=a)},null,8,["value"])]),_:1})]}),_:1},8,["model","rules","validate-messages"])]),_:1},8,["visible","title"])])]),_:1})}const $=U(N,[["render",H]]);export{$ as default};
