import{_ as q}from"./AdminLayout.a967bfb7.js";import{q as A}from"./index.daf4e683.js";import{_ as O}from"./_plugin-vue_export-helper.cdc0426e.js";import{U as T}from"./UploadOutlined.51045c55.js";import{R as F}from"./RestFilled.0825d20b.js";import{C as i,o as s,c as _,w as l,a as k,b as n,d as m,f as u,F as v,t as y,e as h}from"./app.c082a298.js";import"./UserOutlined.2068f525.js";import"./AppstoreOutlined.a785b156.js";const M={components:{AdminLayout:q,UploadOutlined:T,RestFilled:F,quillEditor:A},props:["messageCategories","messages","members"],data(){return{modal:{isOpen:!1,data:{},title:"Modal",mode:""},pagination:{total:this.messages.total,current:this.messages.current_page,pageSize:this.messages.per_page},filter:{},columns:[{title:"\u5206\u985E",dataIndex:"category",width:80},{title:"\u6A19\u984C",dataIndex:"title"},{title:"\u767C\u4EF6\u4EBA",dataIndex:"sender",width:120},{title:"\u6536\u4EF6\u4EBA",dataIndex:"receiver",width:120},{title:"\u64CD\u4F5C",dataIndex:"operation",key:"operation"}],rules:{field:{required:!0},label:{required:!0}},validateMessages:{required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}},labelCol:{style:{width:"150px"}}}},created(){},methods:{createRecord(o){this.modal.data={},this.modal.mode="CREATE",this.modal.isOpen=!0},editRecord(o){this.modal.data={...o},this.modal.mode="EDIT",this.modal.isOpen=!0},storeRecord(){this.$refs.modalRef.validateFields().then(()=>{this.$inertia.post(route("admin.messages.store"),this.modal.data,{onSuccess:o=>{this.modal.isOpen=!1},onError:o=>{console.log(o)}})}).catch(o=>{console.log(o)})},updateRecord(){this.$refs.modalRef.validateFields().then(()=>{this.modal.data._method="PATCH",this.$inertia.post(route("admin.messages.update",this.modal.data.id),this.modal.data,{onSuccess:o=>{this.modal.isOpen=!1},onError:o=>{console.log(o)}})}).catch(o=>{console.log("error",o)})},deleteRecord(o){!confirm("Are you sure want to remove?")||this.$inertia.delete(route("admin.forms.destroy",{form:o.id}),{onSuccess:e=>{console.log(e)},onError:e=>{alert(e.message)}})},onPaginationChange(o,e,p){this.$inertia.get(route("admin.messages.index"),{page:o.current,per_page:5,filter:"namejose"},{onSuccess:g=>{console.log(g)},onError:g=>{console.log(g)}})}}},B=k("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Messenger ",-1),D={key:0},N={key:1};function V(o,e,p,g,t,d){const f=i("a-button"),R=i("a-table"),x=i("a-select"),c=i("a-form-item"),C=i("a-input"),E=i("quill-editor"),w=i("a-form"),I=i("a-modal"),U=i("AdminLayout");return s(),_(U,{title:"Dashboard"},{header:l(()=>[B]),default:l(()=>[k("button",{onClick:e[0]||(e[0]=a=>d.createRecord()),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded my-3"},"\u65B0\u589E\u901A\u4FE1"),n(R,{dataSource:p.messages.data,columns:t.columns,pagination:t.pagination,onChange:d.onPaginationChange,ref:"dataTable"},{bodyCell:l(({column:a,text:S,record:r,index:L})=>[a.dataIndex=="operation"?(s(),m(v,{key:0},[n(f,{onClick:b=>d.editRecord(r)},{default:l(()=>[u("\u4FEE\u6539")]),_:2},1032,["onClick"]),n(f,{onClick:b=>d.deleteRecord(r.id)},{default:l(()=>[u("\u522A\u9664")]),_:2},1032,["onClick"])],64)):a.dataIndex=="category"?(s(),m(v,{key:1},[u(y(p.messageCategories.find(b=>b.value==S).label),1)],64)):a.dataIndex=="receiver"?(s(),m(v,{key:2},[r.category=="personal"&&r.received_member?(s(),m("p",D,y(r.received_member.display_name),1)):(s(),m("p",N,"--"))],64)):(s(),m(v,{key:3},[u(y(r[a.dataIndex]),1)],64))]),_:1},8,["dataSource","columns","pagination","onChange"]),n(I,{visible:t.modal.isOpen,"onUpdate:visible":e[8]||(e[8]=a=>t.modal.isOpen=a),title:t.modal.title,width:"60%"},{footer:l(()=>[t.modal.mode=="EDIT"?(s(),_(f,{key:"Update",type:"primary",onClick:e[6]||(e[6]=a=>d.updateRecord())},{default:l(()=>[u("Update")]),_:1})):h("",!0),t.modal.mode=="CREATE"?(s(),_(f,{key:"Store",type:"primary",onClick:e[7]||(e[7]=a=>d.storeRecord())},{default:l(()=>[u("Add")]),_:1})):h("",!0)]),default:l(()=>[n(w,{ref:"modalRef",model:t.modal.data,name:"Teacher","label-col":{span:4},"wrapper-col":{span:20},autocomplete:"off",rules:t.rules,"validate-messages":t.validateMessages},{default:l(()=>[n(c,{label:"\u5206\u985E",name:"category"},{default:l(()=>[n(x,{value:t.modal.data.category,"onUpdate:value":e[1]||(e[1]=a=>t.modal.data.category=a),options:p.messageCategories},null,8,["value","options"])]),_:1}),t.modal.data.category=="personal"?(s(),_(c,{key:0,label:"\u6536\u4EF6\u4EBA",name:"receiver"},{default:l(()=>[n(x,{value:t.modal.data.receiver,"onUpdate:value":e[2]||(e[2]=a=>t.modal.data.receiver=a),options:p.members,"field-names":{label:"display_name",value:"id"}},null,8,["value","options"])]),_:1})):h("",!0),n(c,{label:"\u767C\u4EF6\u4EBA",name:"sender"},{default:l(()=>[n(C,{value:t.modal.data.sender,"onUpdate:value":e[3]||(e[3]=a=>t.modal.data.sender=a)},null,8,["value"])]),_:1}),n(c,{label:"\u6A19\u984C",name:"title"},{default:l(()=>[n(C,{value:t.modal.data.title,"onUpdate:value":e[4]||(e[4]=a=>t.modal.data.title=a)},null,8,["value"])]),_:1}),n(c,{label:"\u5167\u5BB9",name:"content"},{default:l(()=>[n(E,{value:t.modal.data.content,"onUpdate:value":e[5]||(e[5]=a=>t.modal.data.content=a),style:{"min-height":"200px"}},null,8,["value"])]),_:1})]),_:1},8,["model","rules","validate-messages"])]),_:1},8,["visible","title"])]),_:1})}const W=O(M,[["render",V]]);export{W as default};
